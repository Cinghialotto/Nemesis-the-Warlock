          ORG &8000          ; NEMESIS SOURCE          ; STARTED 29/12/1986          ; COPYRIGHT 1986/87          ; MICHAEL ARCHERSYNC      EQU &02LEFT      EQU SYNC+1RIGHT     EQU LEFT+1UP        EQU RIGHT+1DOWN      EQU UP+1FIRE      EQU DOWN+1JOY       EQU FIRE+1     ; 1TEMP      EQU JOY+1      ; 2TEMP2     EQU TEMP+2     ; 2TEMP3     EQU TEMP2+2    ; 2TEMP4     EQU TEMP3+2MIKE      EQU TEMP4+2    ; 2MIKE2     EQU MIKE+2     ; 2SPARE     EQU MIKE2+2    ; 1XTEMP     EQU SPARE+1    ; 1YTEMP     EQU XTEMP+1    ; 1ATEMP     EQU YTEMP+1    ; ALIEN BYTE'SNEWX      EQU ATEMP+3    ; START OFNEWY      EQU NEWX+1     ; NEW SCREENX         EQU NEWY+1     ; ALL X'SSIDEX     EQU X+5        ; GUN,SWORDY         EQU SIDEX+5    ; AND Y POS.SIDEY     EQU Y+5        ; ALONG SIDESFRAME     EQU SIDEY+5    ; WALKINGDIRECTION EQU FRAME+5    ; FACEINGACTION    EQU DIRECTION+5; DOING WHATCOUNT     EQU ACTION+5   ; FRAME NUMBERTOGGLE    EQU COUNT+6    ; EVERY OTHERMOVES     EQU TOGGLE+4   ; ZOMBIE COUNTSPRITEV0  EQU MOVES+4    ; ALL SPRITESPRITEV1  EQU SPRITEV0+5 ; POINTERSSIDEB     EQU SPRITEV1+5 ; GUN,SWORDBULLETX   EQU SIDEB+3    ; BULLETBULLETX2  EQU BULLETX+6  ; FOR DETECT.BULLETY   EQU BULLETX2+6 ; CORDSBULLETML  EQU BULLETY+6  ; MEMORY LOWBULLETMH  EQU BULLETML+6 ; AND HIGHWBULLET   EQU BULLETMH+6 ; WHOESDBULLET   EQU WBULLET+6  ; DIRECTIONBEHIND1   EQU DBULLET+6  ; BEHIND THEBEHIND2   EQU BEHIND1+6  ; BULLETBULLETS   EQU BEHIND2+6  ; HOW MANYBREATH    EQU BULLETS+1  ; FLAMES ?BREATHD   EQU BREATH+1   ; DIRECTIONBREATHF   EQU BREATHD+1  ; FRAMELEVEL     EQU BREATHF+1  ; GESS WHAT!EXIT      EQU LEVEL+1    ; WHERETOPY      EQU EXIT+1     ; LESS Y CORDSCOREV    EQU TOPY+1     ; 3 BYTESENERGY    EQU SCOREV+3   ; HOW MUCHHITS      EQU ENERGY+1   ; HIT ENEMYSTOKILL    EQU HITS+4     ; TO KILLIRQTEMP   EQU TOKILL+1   ; NEVER EVERNMIHOLD   EQU IRQTEMP+1  ; USE OK.YTABLE    EQU NMIHOLD+3SEEDP     EQU YTABLE+10  ; POINTERSEEDC     EQU SEEDP+1    ; COUNTERFACE      EQU SEEDC+1SEED      EQU FACE+1     ; 10 BYTES          ; 1 FOR EACH WARRIOR/ZOMBIE          ; 2 FOR BRING ON NEMESIS          ; 4 BYTES FOR BRING ON          ; NMIHOLD+0 A          ; NMIHOLD+1 X          ; NMIHOLD+2 YVIC       EQU &D000RASTER    EQU VIC+18BORDER    EQU VIC+32COLOUR0   EQU VIC+33CIA1      EQU &DC00CIA2      EQU &DD00FG0       EQU &ED40     ; SID 0FG1       EQU &ED41     ; SID 1FG2       EQU &ED42     ; SID 2FLUSH     EQU &ED43EFFECTS   EQU &ED46TUNEON    EQU &E009TUNEOFF   EQU &E00CREFRESH   EQU &E00F          ; EQU &0200 TO &04FF FREEMAP       EQU &0500     ; MAP DATASCROLL    EQU &0900     ; FOR TEXTTORQSTORE EQU &0E00     ; TORQUMADORSBACKD    EQU &1000     ; MERGE DATAVALUES    EQU &1100     ; 0 TO 255REVERSE   EQU &1200     ; REVERSE TABLESPSTART   EQU &1300     ; SOFT SPRITESNEMSTART  EQU &B800     ; ALL NEMESISBANK      EQU &4000     ; BANK 2 16KSCREEN    EQU &5C00     ; COLOR 1000BBITMAP    EQU &6000     ; 8KNYBBLE    EQU &D800     ; 1KSPRITE0   EQU SCREEN+1016 ; POINTERSSPRITE1   EQU SPRITE0+1SPRITE2   EQU SPRITE1+1SPRITE3   EQU SPRITE2+1SPRITE4   EQU SPRITE3+1SPRITE5   EQU SPRITE4+1SPRITE6   EQU SPRITE5+1SPRITE7   EQU SPRITE6+1          ; SPRITES &1100 TO &4000          ; EVERYTHING BUT NEMESIS          ; SPRITES &BB00 +          ; ALL NEMESIS          ; HEART AT &4000 ON          ; NORMAL SPRITE POINTERS USED          RUN MAIN          ;DW NMI          ;DW NMI          ;DB &C3,&C2,&CD,&38,&30FIRST     STA NMIHOLD          LDA VIC+25          AND #1          BEQ NORA          STA VIC+25          STA VIC+26SCRON     LDA #%00101011        ; 11          STA VIC+17          LDA RASTER          CMP #185      ; 6          BEQ MULTI          LDA #%00001000          STA VIC+22          STX NMIHOLD+1          STY NMIHOLD+2          JSR REFRESH          LDY NMIHOLD+2          LDX NMIHOLD+1          LDA #185      ; 6          STA RASTER          LDA NMIHOLD          RTIMULTI     CMP &D012          BEQ MULTI          LDA #%00011000          STA VIC+22          LDA #108      ; 7          STA RASTERNORA      LDA NMIHOLD          RTIIRQ       STA NMIHOLD          LDA VIC+25          AND #1          BEQ NORA          STA VIC+25          STA VIC+26          LDA RASTER          BEQ SCONSCOF      LDA #%00100011 ; +- 16          STA VIC+17SPRIT     LDA #%00000000          STA VIC+21          LDA #160-24    ; SCORE          STA VIC+8      ; SPR 4          LDA #160+24          STA VIC+14     ; SPR 7          LDA #252          STA VIC+9      ; SPR 4          STA VIC+15     ; SPR 7          LDA #253          STA SPRITE4          LDA #254          STA SPRITE7          LDA #12          STA VIC+43          STA VIC+46    ; COLOUR SPR7          LDA #%10010000; EXPAND Y          STA VIC+23          STA VIC+29    ; EXPAND X          LDA #0          STA RASTER          LDA NMIHOLD          RTISCON      LDA #%00101011 ; +- 16          STA VIC+17COLMODET  LDA #%00011000          STA VIC+22     ; MULTI/HIRESCOLBG     LDA #11          STA COLOUR0          LDA #14          STA VIC+39    ; COLOUR SPR0          LDA #%00000000; NO EXPAND Y          STA VIC+23          STA VIC+29    ; NO EXPAND X          STA VIC+38    ; SMC1          LDA #%11111111          STA VIC+28    ; MULTICOL SPR          LDA #6          STA VIC+37    ; SMC0          LDA #12          STA VIC+40    ; COLOUR SPR1          STA VIC+41          STA VIC+42          STA VIC+43          STA VIC+45SIDEC     LDA #255      ; SIDEC          STA VIC+44          LDA #0          STA IRQTEMP          LDA X+0       ; NEMESIS          ASL A          ROR IRQTEMP          STA VIC+0          LDA X+1       ; ENEMY 0          ASL A          ROR IRQTEMP          STA VIC+2          LDA X+2       ; ENEMY 1          ASL A          ROR IRQTEMP          STA VIC+4          LDA X+3       ; ENEMY 2          ASL A          ROR IRQTEMP          STA VIC+6          LDA X+4       ; ENEMY 3          ASL A          ROR IRQTEMP          STA VIC+8          LDA SIDEX+0   ; NEMESIS          ASL A         ; GUN ETC.          ROR IRQTEMP          STA VIC+10          LDA SIDEX+1   ; ENEMY 0          ASL A         ; GUN ETC.          ROR IRQTEMP          STA VIC+12          LDA SIDEX+2   ; ENEMY 1          ASL A         ; GUN ETC.          ROR IRQTEMP          STA VIC+14          LDA IRQTEMP          STA VIC+16YCOR0     LDA #255      ; NEMESIS          STA VIC+1          STA VIC+11    ; HIS GUNYCOR1     LDA #255      ; ENEMY 0          STA VIC+3          CLC           ; 0 OR 21          ADC SIDEY+1   ; GUN,ETC          STA VIC+13YCOR2     LDA #255      ; ENEMY 1          STA VIC+5          CLC   ; ???          ADC SIDEY+2   ; GUN,ETC          STA VIC+15YCOR3     LDA #255      ; ENEMY 2          STA VIC+7YCOR4     LDA #255      ; ENEMY 3          STA VIC+9          LDA #099      ; NEMESIS          STA SPRITE0   ; ALLSO 104          LDA #100      ; ENEMY 0          STA SPRITE1   ; ALLSO 105          LDA #101      ; ENEMY 1          STA SPRITE2   ; ALLSO 106          LDA #102      ; ENEMY 2          STA SPRITE3   ; ALLSO 107          LDA #103      ; ENEMY 3          STA SPRITE4   ; ALLSO 108          LDA #109      ; NEMESIS          STA SPRITE5   ; GUN,SWORD          LDA #110      ; ENEMY GUN,          STA SPRITE6   ; SWORD 0          LDA #111      ; ENEMY GUN,          STA SPRITE7   ; SWORD 1          LDA #< SPRIRQ1          STA &FFFE          LDA #> SPRIRQ1          STA &FFFFRAST1     LDA #70       ; CHANGES          STA RASTER          LDA NMIHOLDNMIRESET     RTISPRIRQ1   STA NMIHOLD          LDA #1          STA VIC+25POV1      LDA #255POI1      STA SPRITE0CORD1     LDA #255SPR1      STA VIC+1BRA1      JMP POV2          LDA #< SPRIRQ2          STA &FFFE          LDA #> SPRIRQ2          STA &FFFFRAST2     LDA #80          STA RASTER          LDA NMIHOLD          RTISPRIRQ2   STA NMIHOLD          LDA #1          STA VIC+25POV2      LDA #255POI2      STA SPRITE0CORD2     LDA #255SPR2      STA VIC+1BRA2      JMP POV3          LDA #< SPRIRQ3          STA &FFFE          LDA #> SPRIRQ3          STA &FFFFRAST3     LDA #90          STA RASTER          LDA NMIHOLD          RTISPRIRQ3   STA NMIHOLD          LDA #1          STA VIC+25POV3      LDA #255POI3      STA SPRITE0CORD3     LDA #255SPR3      STA VIC+1BRA3      JMP POV4          LDA #< SPRIRQ4          STA &FFFE          LDA #> SPRIRQ4          STA &FFFFRAST4     LDA #100          STA RASTER          LDA NMIHOLD          RTISPRIRQ4   STA NMIHOLD          LDA #1          STA VIC+25POV4      LDA #255POI4      STA SPRITE0CORD4     LDA #255SPR4      STA VIC+1BRA4      JMP POV5          LDA #< SPRIRQ5          STA &FFFE          LDA #> SPRIRQ5          STA &FFFFRAST5     LDA #110          STA RASTER          LDA NMIHOLD          RTISPRIRQ5   STA NMIHOLD          LDA #1          STA VIC+25POV5      LDA #255POI5      STA SPRITE0CORD5     LDA #255SPR5      STA VIC+1BRA5      JMP POV6          LDA #< SPRIRQ6          STA &FFFE          LDA #> SPRIRQ6          STA &FFFFRAST6     LDA #192          STA RASTER          LDA NMIHOLD          RTISPRIRQ6   STA NMIHOLD          LDA #1          STA VIC+25POV6      LDA #255POI6      STA SPRITE0   ; +2CORD6     LDA #255SPR6      STA VIC+1BRA6      JMP POV7          LDA #< SPRIRQ7          STA &FFFE          LDA #> SPRIRQ7          STA &FFFFRAST7     LDA #80          STA RASTER          LDA NMIHOLD          RTISPRIRQ7   STA NMIHOLD          LDA #1          STA VIC+25POV7      LDA #255POI7      STA SPRITE0CORD7     LDA #255SPR7      STA VIC+1BRA7      JMP POV8          LDA #< SPRIRQ8          STA &FFFE          LDA #> SPRIRQ8          STA &FFFFRAST8     LDA #90          STA RASTER          LDA NMIHOLD          RTISPRIRQ8   STA NMIHOLD          LDA #1          STA VIC+25POV8      LDA #255POI8      STA SPRITE0CORD8     LDA #255SPR8      STA VIC+1BRA8      JMP POV9          LDA #< SPRIRQ9          STA &FFFE          LDA #> SPRIRQ9          STA &FFFFRAST9     LDA #100          STA RASTER          LDA NMIHOLD          RTISPRIRQ9   STA NMIHOLD          LDA #1          STA VIC+25POV9      LDA #255POI9      STA SPRITE0CORD9     LDA #255SPR9      STA VIC+1BRA9      JMP POVA          LDA #< SPRIRQA          STA &FFFE          LDA #> SPRIRQA          STA &FFFFRASTA     LDA #110          STA RASTER          LDA NMIHOLD          RTISPRIRQA   STA NMIHOLD          LDA #1          STA VIC+25POVA      LDA #255POIA      STA SPRITE0          LDA #< SORT1          STA &FFFE          LDA #> SORT1          STA &FFFF          DEC SYNC          LDA #183      ; HUMMM 9          STA RASTER          LDA NMIHOLD          RTISORT1     STA NMIHOLD          LDA RASTERSMOOTH    CMP RASTER          BEQ SMOOTH          LDA #0          STA COLOUR0          LDA #%00011000          STA VIC+22          STX NMIHOLD+1          STY NMIHOLD+2          LDA #44        ; HEART          STA VIC+0      ; SPR 0          STA VIC+4      ; SPR 2          LDA #44+24          STA VIC+2      ; SPR 1          STA VIC+6      ; SPR 3          LDA #196          STA VIC+1      ; SPR 0          STA VIC+3      ; SPR 2          LDA #193+24          STA VIC+5      ; SPR 1          STA VIC+7      ; SPR 3          LDA ENERGY          AND #%11110000          LSR A          LSR A          TAX          STX SPRITE0          INX          STX SPRITE1          INX          STX SPRITE2          INX          STX SPRITE3          LDX #96          STX SPRITE4          INX          STX SPRITE5          INX          STX SPRITE6          LDA #130       ; SPR 4          STA VIC+8          LDA #214       ; SPR 4          STA VIC+9          LDA #242       ; SPR 5          STA VIC+10          LDA #250-9     ; SPR 5          STA VIC+11          LDA #60          STA VIC+12     ; SPR 6          LDA #250-9          STA VIC+13     ; SPR 6          LDA #%00001111          STA VIC+28    ; MULTICOL SPR          LDA #0          STA VIC+16    ; NO MSB          LDA #8          STA VIC+39    ; COLOUR SPR0          STA VIC+40    ; COLOUR SPR1          STA VIC+41    ; COLOUR SPR2          STA VIC+42    ; COLOUR SPR3          LDA #0          STA VIC+43    ; COLOUR SPR4          STA VIC+44    ; COLOUR SPR5          STA VIC+45    ; COLOUR SPR6          LDA #2          STA VIC+37    ; SMC0          LDA #9          STA VIC+38    ; CMC1TURNOF2   LDA #%00000000 ; TURN ON          STA VIC+21     ; ALL SPRITES          STA VIC+25          JSR EFFECTS          ; MEGA MEGA MEGA ROUTINE          LDA Y+0          CMP #137          BCC TRE1          LDA #137TRE1      CLC          ADC #6          STA YCOR0+1          ADC #19          STA YTABLE+0          ADC #19       ; 18          STA YTABLE+5  ; TURN OFF          LDA Y+1          CMP #137          BCC TRE2          LDA #137TRE2      CLC          ADC #6          STA YCOR1+1          ADC #19          STA YTABLE+1          ADC #19       ; 18          STA YTABLE+6  ; TURN OFF          LDA Y+2          CMP #137          BCC TRE3          LDA #137TRE3      CLC          ADC #6          STA YCOR2+1          ADC #19          STA YTABLE+2          ADC #19       ; 18          STA YTABLE+7  ; TURN OFF          LDA Y+3          CMP #137          BCC TRE4          LDA #137TRE4      CLC          ADC #6          STA YCOR3+1          ADC #19          STA YTABLE+3          ADC #19          STA YTABLE+8  ; TURN OFF          LDA Y+4          CMP #137          BCC TRE5          LDA #137TRE5      CLC          ADC #6          STA YCOR4+1          ADC #19          STA YTABLE+4          ADC #19          STA YTABLE+9  ; TURN OFF          LDA YTABLE+0          JSR SORT          STA RAST1+1    ; VALUE          CLC          ADC #2          STA CORD1+1    ; NEW CORD          LDA CORDNT,X          STA SPR1+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV1+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI1+1     ; VALUE          LDA YTABLE+1          JSR SORT          LDY #&2C          STA RAST2+1    ; VALUE          CLC          ADC #2          STA CORD2+1          LDA RAST1+1          CLC          ADC #2          CMP RAST2+1          BCC NSAME1          LDY #&4CNSAME1    STY BRA1          LDA CORDNT,X          STA SPR2+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV2+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI2+1     ; VALUE          LDA YTABLE+2          JSR SORT          LDY #&2C          STA RAST3+1    ; VALUE          CLC          ADC #2          STA CORD3+1          LDA RAST2+1          CLC          ADC #2          CMP RAST3+1          BCC NSAME2          LDY #&4CNSAME2    STY BRA2          LDA CORDNT,X          STA SPR3+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV3+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI3+1     ; VALUE          LDA YTABLE+3          JSR SORT          LDY #&2C          STA RAST4+1    ; VALUE          CLC          ADC #2          STA CORD4+1          LDA RAST3+1          CLC          ADC #2          CMP RAST4+1          BCC NSAME3          LDY #&4CNSAME3    STY BRA3          LDA CORDNT,X          STA SPR4+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV4+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI4+1     ; VALUE          LDA YTABLE+4          JSR SORT          LDY #&2C          STA RAST5+1    ; VALUE          CLC          ADC #2          STA CORD5+1          LDA RAST4+1          CLC          ADC #2          CMP RAST5+1          BCC NSAME4          LDY #&4CNSAME4    STY BRA4          LDA CORDNT,X          STA SPR5+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV5+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI5+1     ; VALUE          LDA YTABLE+5          JSR SORT          LDY #&2C          STA RAST6+1    ; VALUE          CLC          ADC #2          STA CORD6+1          LDA RAST5+1          CLC          ADC #2          CMP RAST6+1          BCC NSAME5          LDY #&4CNSAME5    STY BRA5          LDA CORDNT,X          STA SPR6+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV6+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI6+1     ; VALUE          LDA YTABLE+6          JSR SORT          LDY #&2C          STA RAST7+1    ; VALUE          CLC          ADC #2          STA CORD7+1          LDA RAST6+1          CLC          ADC #2          CMP RAST7+1          BCC NSAME6          LDY #&4CNSAME6    STY BRA6          LDA CORDNT,X          STA SPR7+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV7+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI7+1     ; VALUE          LDA YTABLE+7          JSR SORT          LDY #&2C          STA RAST8+1    ; VALUE          CLC          ADC #2          STA CORD8+1          LDA RAST7+1          CLC          ADC #2          CMP RAST8+1          BCC NSAME7          LDY #&4CNSAME7    STY BRA7          LDA CORDNT,X          STA SPR8+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV8+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI8+1     ; VALUE          LDA YTABLE+8          JSR SORT          LDY #&2C          STA RAST9+1    ; VALUE          CLC          ADC #2          STA CORD9+1          LDA RAST8+1          CLC          ADC #2          CMP RAST9+1          BCC NSAME8          LDY #&4CNSAME8    STY BRA8          LDA CORDNT,X          STA SPR9+1     ; NUMBER          LDA BOTV,X     ; BOTTOM          STA POV9+1     ; SPRITE          LDA WHSPR,X    ; POINTER          STA POI9+1     ; VALUE          LDA YTABLE+9          JSR SORT          LDY #&2C          STA RASTA+1    ; VALUE          LDA RAST9+1          CLC          ADC #2          CMP RASTA+1          BCC NSAME9          LDY #&4CNSAME9    STY BRA9          LDA WHSPR,X          STA POIA+1          LDX NMIHOLD+1          LDY NMIHOLD+2          LDA #< IRQ          STA &FFFE          LDA #> IRQ          STA &FFFF          LDA #249      ; 250          STA RASTER          LDA NMIHOLD          RTISORT      CMP YTABLE+9          BCC LES1          LDX #9          LDA YTABLE+9LES1      CMP YTABLE+8          BCC LES2          LDX #8          LDA YTABLE+8LES2      CMP YTABLE+7          BCC LES3          LDX #7          LDA YTABLE+7LES3      CMP YTABLE+6          BCC LES4          LDX #6          LDA YTABLE+6LES4      CMP YTABLE+5          BCC LES5          LDX #5          LDA YTABLE+5LES5      CMP YTABLE+4          BCC LES6          LDX #4          LDA YTABLE+4LES6      CMP YTABLE+3          BCC LES7          LDX #3          LDA YTABLE+3LES7      CMP YTABLE+2          BCC LES8          LDX #2          LDA YTABLE+2LES8      CMP YTABLE+1          BCC LES9          LDX #1          LDA YTABLE+1LES9      CMP YTABLE+0          BCC LESA          LDX #0          LDA YTABLE+0LESA      LDY #255          STY YTABLE+0,X          RTSWHSPR     DB < SPRITE0          DB < SPRITE1          DB < SPRITE2          DB < SPRITE3          DB < SPRITE4          DB < SPRITE0          DB < SPRITE1          DB < SPRITE2          DB < SPRITE3          DB < SPRITE4CORDNT    DB 1,3,5,7,9          DB 47,47,47,47,47          ; NOT USED IN VIC CHIP          INFO "R.NEMESIS "