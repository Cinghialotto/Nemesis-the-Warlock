          ; ROUTINES TO DO WITH          ; THE LEVELS          ; WHAT YOU ARE STANDING ONWHERE     LDA Y+0 ; YOUR Y CORDINATELOOKUP    LSR A          LSR A          LSR A          TAY          LDA X+0 ; YOUR X CORDINATE          SEC          SBC #12          LSR A          LSR A          CLC          ADC MAPTL-1,Y          STA MIKE2          LDA MAPTH-1,Y          ADC #0          STA MIKE2+1          LDY #1          LDA (MIKE2),Y          RTS          ; WHAT ALIENS ARE STANDING ONAWHERE    LDA Y+0,XLOOKUP2   LSR A          LSR A          LSR A          TAY          LDA X+0,X          SEC          SBC #12          LSR A          LSR A          CLC          ADC MAPTL-1,Y          STA MIKE2          LDA MAPTH-1,Y          ADC #0          STA MIKE2+1          LDY #1          LDA (MIKE2),Y          RTS          ; PLOT LEVEL AT X,Y LENGH ADISPL     LDY LEVEL          LDA LEVELTL,Y          STA MIKE2          LDA LEVELTH,Y          STA MIKE2+1MOROFL    LDY #0          LDA (MIKE2),Y ; X          CMP #255          BEQ EXIT6          TAX          STX TEMP          INY          LDA (MIKE2),Y ; Y          STA SPARE          INY          LDA (MIKE2),Y ; LENGTH          SEC          SBC TEMP          LDY SPARE          JSR PLATFORM          LDA MIKE2          CLC          ADC #3          STA MIKE2          BCC MOROFL          INC MIKE2+1          BNE MOROFLEXIT6     JMP PAMMOPLATFORM  JSR PLEVEL          LDA YTEMP          CMP #15          BCC NOBOG          RTSNOBOG     LDA SPARE     ; HALF OF          LSR A         ; LENGTH          CLC           ; + START X          ADC XTEMP     ; MINUS 1          TAX           ; AS 3 CHARS          DEX           ; FOR STEM          LDY YTEMP     ; 1 CHAR          INY           ; BELOW          JSR MEMXY          LDY #2COLSTUF   LDA #0        ; COL3 0          STA (TEMP2),Y ; NYBBLE          LDA #%10001001 ; COL1 8          STA (TEMP3),Y ; COL2 9          DEY          BPL COLSTUF          LDY #23STEMS     LDA YTEMP          AND #1          BEQ RANDY          LDA JOIN1,Y          BNE ALLWRANDY     LDA JOIN2,YALLW      STA MERG5+1          STA DAT+1MERG5     LDA SBACKD          AND (TEMP),YDAT       ORA #255          STA (TEMP),Y  ; ALL THREE          DEY          BPL STEMS          LDA TEMP          CLC          ADC #8          STA TEMP          BCC NOCC          INC TEMP+1NOCC      LDX YTEMP     ; ON PLAT          INX   ; PAST THE BIG BIT          INX   ; ONTO NEW PARTDOWNLO    LDA TEMP          CLC          ADC #< 320          STA TEMP          LDA TEMP+1          ADC #> 320          STA TEMP+1          LDA TEMP2          CLC          ADC #40          STA TEMP2          BCC COLB          INC TEMP2+1COLB      LDA TEMP3          CLC          ADC #40          STA TEMP3          BCC COLB2          INC TEMP3+1COLB2     LDY #7WIZARD    TXA          AND #1          BEQ JOAT          LDA BOTSTEM,Y          BNE JOAT2JOAT      LDA JOINSTEM,YJOAT2     STA MERG6+1          STA DATV+1MERG6     LDA SBACKD          AND (TEMP),YDATV      ORA #255          STA (TEMP),Y          DEY          BPL WIZARD          LDY #1          LDA #0        ; COL3 0          STA (TEMP2),Y ; NYBBLE          LDA #%10001001 ; COL1 8          STA (TEMP3),Y ; COL2 9          INX           ; REPEAT          CPX #17       ; UNTIL BOTTOM          BCC DOWNLO     ; OF SCREEN          RTSPLEVEL    STX XTEMP          STY YTEMP          STA SPARE          SEC          SBC #1          STA MIKE          STA MIKE+1    ; HANGING          JSR MEMXY          LDY SPAREALLOF     LDA #0        ; COL3 0          STA (TEMP2),Y ; NYBBLE          LDA #%10001001 ; COL1 8          STA (TEMP3),Y ; COL2 9          LDA #255      ; LEVEL THERE          STA (TEMP4),Y ; IN MAP          DEY          BPL ALLOF          LDY #7STL       LDA SLEVEL,Y  ; START          STA MERGE1+1MERGE1    LDA SBACKD          AND (TEMP),Y  ; TRY OUT          ORA SLEVEL,Y          STA (TEMP),Y  ; SCREEN          DEY          BPL STL          LDA TEMP          CLC          ADC #8          STA TEMP          BCC STOREB          INC TEMP+1STOREB    LDA TEMP          CLC          ADC #&40          STA TEMP2          LDA TEMP+1          ADC #1          STA TEMP2+1LOOFT1    LDY #7MNL1      LDA MLEVEL1,Y ; MIDDLE 1          STA (TEMP),Y  ; SCREEN          DEY          BPL MNL1          LDA TEMP          CLC          ADC #8          STA TEMP          BCC PT1          INC TEMP+1PT1       DEC MIKE          BEQ ENDOFPL          LDY #7MNL2      LDA MLEVEL2,Y ; MIDDLE 2          STA (TEMP),Y  ; SCREEN          DEY          BPL MNL2          LDA TEMP          CLC          ADC #8          STA TEMP          BCC PT2          INC TEMP+1PT2       DEC MIKE          BEQ ENDOFPL          LDY #7MNL3      LDA MLEVEL3,Y ; MIDDLE 3          STA (TEMP),Y  ; SCREEN          DEY          BPL MNL3          LDA TEMP          CLC          ADC #8          STA TEMP          BCC PT3          INC TEMP+1PT3       DEC MIKE          BNE LOOFT1ENDOFPL   LDY #7ETL       LDA ELEVEL,Y  ; END          STA MERGE2+1MERGE2    LDA SBACKD          AND (TEMP),Y  ; TRY OUT          ORA ELEVEL,Y          STA (TEMP),Y  ; SCREN          DEY          BPL ETL          LDA YTEMP          CMP #16       ; 17          BCS ENDOFHAGOAHEAD   LDY #7MNL4      LDA HANG1,Y    ; HANGING 1          STA MERGE3+1MERGE3    LDA SBACKD          AND (TEMP2),Y  ; TRY OUT          ORA HANG1,Y    ; TRY OUT          STA (TEMP2),Y  ; SCREEN          DEY          BPL MNL4          LDA TEMP2          CLC          ADC #8          STA TEMP2          BCC PT4          INC TEMP2+1PT4       DEC MIKE+1          BEQ ENDOFHA          LDY #7MNL5      LDA HANG2,Y   ; HANGING 2          STA MERGE4+1MERGE4    LDA SBACKD          AND (TEMP2),Y  ; TRY OUT          ORA HANG2,Y          STA (TEMP2),Y  ; SCREEN          DEY          BPL MNL5          LDA TEMP2          CLC          ADC #8          STA TEMP2          BCC PT5          INC TEMP2+1PT5       DEC MIKE+1          BNE GOAHEADENDOFHA   RTS          ; WORK OUT MEM FOR X,Y          ; FOR BIT MAP SCREEN          ; AND COLOUR MEMORYMEMXY     LDA #0          STA TEMP+1          TXA          ASL A          ROL TEMP+1          ASL A          ROL TEMP+1          ASL A          ROL TEMP+1          CLC          ADC M320L,Y          STA TEMP      ; SCREEN LOW          LDA TEMP+1          ADC M320H,Y          STA TEMP+1    ; SCREEN HIGH          TXA          CLC          ADC MAPTL,Y          STA TEMP2     ; NYBBLE LOW          STA TEMP3     ; COLOUR LOW          STA TEMP4     ; MAP LOW          LDA MAPTH,Y          ADC #0        ; ????          STA TEMP4+1   ; MAP HIGH          ADC #>(SCREEN-MAP)          STA TEMP3+1   ; COLOUR HIGH          ADC #>(NYBBLE-SCREEN)          STA TEMP2+1   ; NYBBLE HIGHEXIT2     RTSPAMMO     LDY #1          LDA (MIKE2),Y ; X          CMP #255          BEQ EXIT2          TAX          INY          LDA (MIKE2),Y ; Y          TAY          JSR MEMXY          LDY #7AMPL      LDA AMMO,Y          STA MERGE5+1MERGE5    LDA SBACKD          AND (TEMP),Y          ORA AMMO,Y          STA (TEMP),Y          DEY          BPL AMPL          INY          LDA #%10111100          STA (TEMP3),Y ; COLOUR          LDA #%00000000          STA (TEMP2),Y ; NYBBLR          LDA #128          STA (TEMP4),Y ; MAP          LDA MIKE2          CLC          ADC #2          STA MIKE2          BCC PAMMO          INC MIKE2+1          BNE PAMMOAMMO      DB &00,&00,&3C,&E7          DB &E9,&E7,&E9,&F7          ; 0SLEVEL    DB &FF,&EE,&9E,&19          DB &25,&6,&A,&2          ; 1MLEVEL1   DB &FF,&FF,&BB,&7B          DB &B6,&6D,&DF,&FF          ; 2MLEVEL2   DB &FF,&FF,&AF,&9B          DB &9B,&B9,&7D,&FF          ; 3MLEVEL3   DB &FF,&FF,&EF,&EB          DB &DB,&6E,&7F,&CC          ; 4ELEVEL    DB &FF,&BB,&B6,&B4          DB &98,&90,&A0,&80          ; 5HANG1     DB &FF,&FF,&33,&30          DB &30,&0,&0,&0          ; 6HANG2     DB &FF,&FF,&CF,&CF          DB &3,&C0,&3,&0          ; 7BOTSTEM   DB &D7,&DC,&37,&DB          DB &EC,&3B,&EB,&D9          ; 15JOIN1     DB &FF,&FF,&3B,&EB          DB &F9,&CE,&3,&3          ; 16          DB &FF,&F3,&F3,&DC          DB &5C,&AF,&D7,&E7          ; 17          DB &FF,&FF,&F7,&BC          DB &70,&BC,&CC,&C0          ; 18JOINSTEM  DB &EF,&DB,&DC,&37          DB &DB,&EC,&3B,&E7          ; 19JOIN2     DB &FF,&3F,&3F,&D          DB &3E,&39,&37,&F          ; 20          DB &FF,&FF,&F3,&BF          DB &7F,&BD,&5D,&9D          ; 21          DB &FF,&FC,&FC,&CC          DB &70,&70,&C0,&C0          ; MEM LOW  AT (0 TO 17)M320L     DB &00,&40,&80,&C0          DB &00,&40,&80,&C0          DB &00,&40,&80,&C0          DB &00,&40,&80,&C0          DB &00,&40,&80,&C0          DB &00,&40,&80,&C0          DB &00M320H     DB &60,&61,&62,&63          DB &65,&66,&67,&68          DB &6A,&6B,&6C,&6D          DB &6F,&70,&71,&72          DB &74,&75,&76,&77          DB &79,&7A,&7B,&7C          DB &7EMAPTL     DB &00,&28,&50,&78          DB &A0,&C8,&F0,&18          DB &40,&68,&90,&B8          DB &E0,&08,&30,&58          DB &80,&A8,&D0,&F8          DB &20,&48,&70,&98          DB &C0MAPTH     DB >MAP,>MAP          DB >MAP,>MAP          DB >MAP,>MAP          DB >MAP,(>MAP)+1          DB (>MAP)+1,(>MAP)+1          DB (>MAP)+1,(>MAP)+1          DB (>MAP)+1,(>MAP)+2          DB (>MAP)+2,(>MAP)+2          DB (>MAP)+2,(>MAP)+2          DB (>MAP)+2,(>MAP)+2          DB (>MAP)+3,(>MAP)+3          DB (>MAP)+3,(>MAP)+3          DB (>MAP)+3LEVELTL   DB < LEVEL1,< LEVEL2          DB < LEVEL3,< LEVEL4          DB < LEVEL5,< LEVEL6          DB < LEVEL7,< LEVEL8          DB < LEVEL9,< LEVEL10          DB < LEVEL11,< LEVEL12          DB < LEVEL13,< LEVEL14          DB < LEVEL15,< LEVEL16          DB < LEVEL17,< LEVEL18          DB < LEVEL19,< LEVEL20          DB < LEVEL21,< LEVEL22LEVELTH   DB > LEVEL1,> LEVEL2          DB > LEVEL3,> LEVEL4          DB > LEVEL5,> LEVEL6          DB > LEVEL7,> LEVEL8          DB > LEVEL9,> LEVEL10          DB > LEVEL11,> LEVEL12          DB > LEVEL13,> LEVEL14          DB > LEVEL15,> LEVEL16          DB > LEVEL17,> LEVEL18          DB > LEVEL19,> LEVEL20          DB > LEVEL21,> LEVEL22          ; Y=2 TO 17          ; X=0 TO 39LEVEL1    DB 10,4,39,5,6,11          DB 10,8,32,31,10,36          DB 10,12,32,3,14,11,0,16,39          DB 255,27,15,31,15,35,15,255LEVEL2    DB 0,4,6,7,5,11,12,6,17          DB 32,4,39,29,6,39,26,8,39          DB 23,10,39,20,12,39,17,14,39          DB 0,16,39,255,7,15,15,15          DB 18,13,21,11,24,9,255LEVEL3    DB 8,4,16,17,5,26,27,6,34          DB 35,7,39,29,8,34,5,9,28          DB 0,11,8,9,12,23,0,14,14          DB 15,15,26,27,16,39,255          DB 22,14,8,8,36,6,255LEVEL4    DB 12,5,26,8,7,29,34,8,39          DB 6,9,12,26,9,33,10,13,27          DB 0,15,6,7,16,22,255          DB 4,14,36,7,255LEVEL5    DB 0,8,22,24,8,36,23,11,31          DB 18,14,26,11,16,28,255          DB 13,15,24,13,26,10,255LEVEL6    DB 24,8,39,0,9,7,8,10,12          DB 13,11,23,6,12,12,0,13,5          DB 6,14,10,11,15,16,17,14,24          DB 22,13,28,29,12,39,255          DB 12,14,15,14,2,8,255LEVEL7    DB 0,4,7,0,6,19,31,4,39          DB 21,6,39,8,14,15,0,16,7          DB 26,14,32,33,16,39,255          DB 37,15,2,15,255LEVEL8    DB 15,4,22,0,9,13,31,10,38          DB 25,13,39,0,16,39,255          DB 31,12,33,12,35,12,37,12          DB 33,9,35,9,37,9,255LEVEL9    DB 0,2,10,0,4,9,0,6,13,0,8,15          DB 1,10,12,11,12,16          DB 26,6,34,31,9,39,19,11,27          DB 0,16,39,255          DB 255LEVEL10   DB 0,4,4,0,8,6,0,12,8          DB 0,16,13,30,4,39,32,7,39          DB 33,10,39,31,13,39          DB 26,16,39,255          DB 4,7,5,11,7,15,33,15          DB 33,12,255LEVEL11   DB 0,4,7,0,8,8,0,12,9          DB 0,16,10,28,4,39,29,8,39          DB 30,12,39,31,16,39,255          DB 7,7,8,11,9,15,30,7,31,11          DB 32,15,255LEVEL12   DB 0,16,7,16,16,26,27,7,31          DB 33,7,39,11,8,25,22,11,29          DB 26,13,33,27,14,34,28,15,35          DB 29,16,39,255          DB 18,7,12,7,255LEVEL13   DB 34,3,39,27,4,33,19,5,26          DB 11,6,18,0,7,10,10,8,14          DB 15,9,34,35,10,39,31,11,34          DB 27,12,30,23,13,26,19,14,23          DB 15,15,18,0,16,14,255          DB 6,15,29,3,255LEVEL14   DB 2,6,13,13,7,17,9,8,13          DB 9,10,13,5,11,9,1,12,5          DB 5,13,9,0,16,13,13,11,17          DB 17,12,21,21,13,25          DB 25,8,29,27,10,29          DB 25,12,29,31,6,39,255          DB 6,5,8,5,10,5,255LEVEL15   DB 4,3,8,17,3,21,30,3,34          DB 35,3,39,12,4,16,25,4,29          DB 29,5,33,0,6,8,16,6,20          DB 21,6,25,34,6,38,8,7,12          DB 13,8,17,30,8,34,33,10,37          DB 4,11,8,15,11,19,25,11,32          DB 0,12,4,23,12,28,10,13,14          DB 15,13,19,29,3,33,33,14,37          DB 6,15,10,21,15,25,26,15,30          DB 2,16,6,17,16,21,33,16,37          DB 255,32,2,23,5,29,10,12,12          DB 8,14,34,13,255LEVEL16   DB 0,6,33,35,6,39,0,8,4          DB 6,8,39,0,10,26,28,10,39          DB 0,12,11,13,12,39,0,14,20          DB 22,14,39,0,16,39,255,255LEVEL17   DB 0,6,8,9,7,14,15,8,23          DB 2,9,7,11,11,16,17,13,21          DB 0,14,7,32,9,39,27,10,31          DB 31,11,35,27,12,31          DB 31,13,35,27,14,31,0,16,39          DB 255,12,6,19,7,255LEVEL18   DB 0,7,16,20,7,24,25,7,29          DB 30,8,34,35,8,39,0,15,28          DB 29,16,39,255,1,14,3,14          DB 5,14,7,14,28,6,32,7,255LEVEL19   DB 10,5,14,21,6,25,4,7,8          DB 34,7,39,0,9,5,26,9,30          DB 14,10,18,5,12,9,1,14,5          DB 17,14,21,6,15,10,32,16,36          DB 255,35,15,9,14,20,13,255LEVEL20   DB 0,6,32,35,6,39          DB 0,16,39,255          DB 3,15,4,15,5,15,6,15,7,15          DB 8,15,9,15,10,15,11,15          DB 12,15,13,15,14,15,15,15          DB 255LEVEL21   DB 15,6,19,5,8,10,25,8,29          DB 11,10,15,16,13,20,9,14,13          DB 0,16,5,20,16,24,35,16,39          DB 255,255LEVEL22   DB 6,2,10,16,2,20,27,2,31          DB 9,3,12,25,3,28,11,4,14          DB 23,4,26,13,5,24,11,7,14          DB 16,7,20,23,7,26,13,8,24          DB 11,9,14,23,9,26,16,10,20          DB 16,12,20,16,14,20,16,15,21          DB 15,16,22,255,255HOWMANY   DB &15,&20,&20,&21,&13          DB &17,&20,&35,&20,&09          DB &10,&20,&30,&30,&25          DB &35,&25,&45,&20,&60          DB &10,&99COLTAB    DB 11,12,2,5,11,14,6,7,13          DB 14,9,12,10,11,2,14,8          DB 5,4,6,9,2          ; EXIT TYPE          ; 0 LEFT 1 RIGHT 2 UP 3 DOWNEXITTAB   DB 1,2,2,2,0,3,3,0          DB 2,2,2,1,2,1,3,1          DB 2,1,3,1,3,3TOPYTAB   DB 0,16,16,24,0,0,0,0          DB 16,16,16,0,0,0,0,0          DB 32,0,0,0,0,0TORQDEL   DB 22,21,20,19,18,17,16          DB 15,14,13,12,11,10,9          DB 8,7,6,5,3,2,1          ; UTILITIES FOR GAMECLEAR     ; WIPE BITMAP COLOUR RAM          ; AND NYBBLES ( NOT ALL OF )          ; ONLY 17 LINES          STA COLL+1          LDY #63          LDA #%00000000WIPESPR   STA 253*64+BANK,Y          STA 254*64+BANK,Y          STA 255*64+BANK,Y          DEY          BPL WIPESPR          LDX #< NYBBLE          LDY #> NYBBLE          JSR WIPCOL          LDX #< SCREEN          LDY #> SCREENCOLL      LDA #%00010000          JSR WIPCOL          LDA #0          LDX #< MAP    ; SCREEN          LDY #> MAP    ; MAP ASWELLWIPCOL    STA COLVAL+1          STX MIKE          STY MIKE+1          LDX #17ACRB      LDY #39COLVAL    LDA #0ACROSS    STA (MIKE),Y          DEY          BPL ACROSS          LDA MIKE          CLC          ADC #40          STA MIKE          BCC NONC          INC MIKE+1NONC      DEX          BNE ACRB          LDX #17          LDA #< BITMAP          STA TEMP          LDA #> BITMAP          STA TEMP+1LNWIP     LDA TEMP          STA MIKE          LDA TEMP+1          STA MIKE+1          LDA #0          TAYLLW       STA (MIKE),Y          INY          BNE LLW          INC MIKE+1LLW2      STA (MIKE),Y          INY          CPY #319-255          BNE LLW2          LDA TEMP          CLC          ADC #< 320          STA TEMP          LDA TEMP+1          ADC #> 320          STA TEMP+1          DEX          BNE LNWIP          RTS          ; SCAN JOYSTICKJOYSTICK  LDA CIA1      ; PORT 1 A          ;LDA CIA1+1    ; PORT 2 B          AND #%00011111          EOR #%00011111          STA JOY          LDA #0          LSR JOY          ROL A          STA UP          LDA #0          LSR JOY          ROL A          STA DOWN          LDA #0          LSR JOY          ROL A          STA LEFT          LDA #0          LSR JOY          ROL A          STA RIGHT          LDA #0          LSR JOY          ROL A          STA FIRE          RTS          ; CALL WITH A=NUMBER TO ADD          ; ADD NUMBER TO YOUR SCORESADD      SED          CLC          ADC SCOREV+0          STA SCOREV+0          LDA SCOREV+1          ADC #0          STA SCOREV+1          LDA SCOREV+2          ADC #0          STA SCOREV+2          CLD          RTS          INFO "R.LEVEL "